function y = new_linmix_667(P,PS,T);
% copied from /asl/packages/Genln2/Genln2/new_linmix.f
% also see    /asl/packages/Genln2/Genln2/zpthadj.f
%             TDF = TP - 200.
%             tx=LOG(200.0/TP)
%             YMIXS = COMIXS(1,IQ,IS) + COMIXS(2,IQ,IS)*TDF + 
%     +       COMIXS(3,IQ,IS)*TDF**2 + COMIXS(4,IQ,IS)*TDF**3
%             YMIXF = COMIXF(1,IQ,IS) + COMIXF(2,IQ,IS)*TDF + 
%     +       COMIXF(3,IQ,IS)*TDF**2 + COMIXF(4,IQ,IS)*TDF**3
%             YMIX = PA*YMIXS + (PP - PA)*YMIXF
%             ymix=ymix*EXP(0.75*tx)

tdiff = (T-200);

%C                 1st order line mixing = Y(T)*(200/T)^0.75, with
%C                 Y(T) = COMIX(1) + COMIX(2)*(T - 200) + 
%C                 COMIX(3)*(T - 200)**2 + COMIX(4)*(T - 200)**3
%C

%C  CO2 Q-branch self mixing coefficient data for:
%C  4  667 cm-1  2  1, 626 (Q 2 - Q50, 667-671 cm-1)
      DATA = [...
      4.39434901E+00,-3.85521809E-03, 9.65581951E-06,-2.03656815E-08;
      7.39592075E-01, 9.33419602E-04,-6.42833080E-06, 1.78298239E-08;
      1.04661937E-01, 1.46629381E-03,-7.02160329E-06, 1.80053727E-08;
     -9.85026367E-02, 1.48385980E-03,-6.32686321E-06, 1.56153627E-08;
     -1.78144674E-01, 1.38925793E-03,-5.52921088E-06, 1.32778798E-08;
     -2.10762828E-01, 1.27134533E-03,-4.81555540E-06, 1.13105146E-08;
     -2.22236151E-01, 1.15457777E-03,-4.20678237E-06, 9.69452540E-09;
     -2.23315693E-01, 1.04605972E-03,-3.69168468E-06, 8.36490900E-09;
     -2.19183407E-01, 9.48010466E-04,-3.25646623E-06, 7.26604459E-09;
     -2.12360259E-01, 8.60132935E-04,-2.88682598E-06, 6.34974101E-09;
     -2.04226564E-01, 7.81743315E-04,-2.57184766E-06, 5.58145092E-09;
     -1.95506313E-01, 7.11585095E-04,-2.30070895E-06, 4.92833967E-09;
     -1.86731189E-01, 6.49011459E-04,-2.06734544E-06, 4.37166454E-09;
     -1.78059092E-01, 5.92928594E-04,-1.86545378E-06, 3.89482357E-09;
     -1.69644035E-01, 5.42527667E-04,-1.69020361E-06, 3.48382535E-09;
     -1.61583251E-01, 4.96948675E-04,-1.53733614E-06, 3.12733011E-09;
     -1.53999572E-01, 4.55847198E-04,-1.40512037E-06, 2.82046557E-09;
     -1.46787563E-01, 4.18220429E-04,-1.29030532E-06, 2.55617334E-09;
     -1.40018972E-01, 3.83340064E-04,-1.19102603E-06, 2.33154027E-09;
     -1.33755753E-01, 3.50194109E-04,-1.10514825E-06, 2.14493562E-09;
     -1.28113796E-01, 3.17128848E-04,-1.02871012E-06, 1.99307544E-09;
     -1.23439664E-01, 2.81214353E-04,-9.52375752E-07, 1.86302534E-09;
     -1.20861120E-01, 2.36698818E-04,-8.50837391E-07, 1.70394887E-09;
     -1.24819334E-01, 1.72244950E-04,-6.53704953E-07, 1.33645303E-09;
     -1.63562218E-01, 7.48765623E-05,-1.68711460E-07, 1.62752627E-10 ];

ys = DATA(:,1) + DATA(:,2)*tdiff + DATA(:,3)*tdiff.^2 + DATA(:,4)*tdiff.^3;
ys = ys*(200/T)^0.75;

%C  CO2 Q-branch foreign mixing coefficient data for:
%C  4  667 cm-1  2  1, 626 (Q 2 - Q50, 667-671 cm-1)
       DATA = [...
      3.60118581E+00,-4.21076392E-03, 9.80084782E-06,-1.88997762E-08;
      6.06072813E-01, 5.32444404E-04,-5.00398753E-06, 1.50804767E-08;
      9.29808972E-02, 1.14931517E-03,-5.92150083E-06, 1.57411751E-08;
     -7.19488506E-02, 1.23604737E-03,-5.52452569E-06, 1.39382161E-08;
     -1.38108049E-01, 1.19522970E-03,-4.94836745E-06, 1.20586206E-08;
     -1.66724463E-01, 1.11955326E-03,-4.39786792E-06, 1.04327753E-08;
     -1.78377714E-01, 1.03649832E-03,-3.91087490E-06, 9.07086513E-09;
     -1.81592914E-01, 9.55268546E-04,-3.48802652E-06, 7.93314305E-09;
     -1.80481638E-01, 8.79516475E-04,-3.12350436E-06, 6.97957309E-09;
     -1.77048050E-01, 8.09977710E-04,-2.80843914E-06, 6.17438024E-09;
     -1.72396891E-01, 7.46691001E-04,-2.53547325E-06, 5.49009099E-09;
     -1.67112661E-01, 6.89041725E-04,-2.29741097E-06, 4.90324307E-09;
     -1.61632585E-01, 6.36749267E-04,-2.08963366E-06, 4.39789637E-09;
     -1.56091236E-01, 5.89068156E-04,-1.90742309E-06, 3.96035109E-09;
     -1.50623059E-01, 5.45460636E-04,-1.74727351E-06, 3.58015328E-09;
     -1.45314409E-01, 5.05299969E-04,-1.60598264E-06, 3.24876996E-09;
     -1.40283753E-01, 4.68382655E-04,-1.48214543E-06, 2.96127205E-09;
     -1.35451993E-01, 4.33860646E-04,-1.37325172E-06, 2.71353327E-09;
     -1.30892953E-01, 4.01132502E-04,-1.27748420E-06, 2.50248483E-09;
     -1.26679582E-01, 3.69289955E-04,-1.19078502E-06, 2.31334439E-09;
     -1.22936606E-01, 3.37081616E-04,-1.11400217E-06, 2.17785767E-09;
     -1.20001798E-01, 3.01988831E-04,-1.03183016E-06, 2.03977012E-09;
     -1.18890518E-01, 2.59838305E-04,-9.22697838E-07, 1.85773765E-09;
     -1.23399608E-01, 2.03594820E-04,-7.28701252E-07, 1.46804410E-09;
     -1.56708168E-01, 1.34298371E-04,-3.17138608E-07, 3.94236977E-10];

tdiff = (T-200);
yf = DATA(:,1) + DATA(:,2)*tdiff + DATA(:,3)*tdiff.^2 + DATA(:,4)*tdiff.^3;
yf = yf*(200/T)^0.75;

y = (P-PS)/P*yf + PS/P*ys;

j = 1 : 1 : length(DATA); j = j' * 2;

[j ys yf y]

plot(j,y,'+-')